<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Jam Track Generator</title>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
		
		<script type="module">
			import { generateSourceReleaseHTML } from '/tools/source-settings-templates.js';
			
			window.addEventListener('DOMContentLoaded', () => {
				const container = document.getElementById('source-release-container');
				if (container) {
					const sources = ['itemShop', 'battlePass', 'musicPass', 'legoPass', 'questReward', 'rocketPass'];
					container.innerHTML = generateSourceReleaseHTML(sources, false);
					
					document.dispatchEvent(new CustomEvent('sourceControlsReady'));
				}
			}, { once: true });
		</script>
		
		<script src="./scripts/jam-track-generator.js" type="module"></script>
		<script src="/scripts/pageinfo.js" type="module"></script>
		<script src="/scripts/load-site-notices.js" type="module"></script>

		<link rel="stylesheet" href="./styles/styles.css" />
		<link rel="icon" href="https://static.wikia.nocookie.net/fortnite/images/4/4a/Site-favicon.ico" />
		<link rel="icon" href="/files/images/tool-icons/jam-track-generator.png" />
	</head>

	<body>
		<header>
			<a href="/index.html" id="return-main">
				<span>
					<img src="/files/images/return-icon.png" alt="back" />
				</span>
			</a>
			<img src="/files/images/tool-icons/jam-track-generator.png" alt="logo" id="header-flag" />
			<span style="margin-right: 1rem">
				<h1 class="name">Jam Track Generator</h1>
				<span class="version"></span>
			</span>
		</header>

		<div id="wrapper">
			<main>
				<section>
					<h3>Jam Track Search</h3>
					<input id="jamTrackInput" type="text" placeholder="Enter jam track name" autocomplete="off" />
					<div id="suggestions"></div>
				</section>

				<section id="source-release-container">
					<!-- Source and release controls will be injected here -->
				</section>

				<section>
          <div class="two-column-layout" id="jam-track-settings">
            <div class="column">
              <h4>Track Details</h4>

              <div class="inline-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="featuredRotationCheck">
                  Featured in the Main Stage rotation? (includes JamTrackAppearances)
                </label>
              </div>

              <div class="inline-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="ageRestricted">
                  Age Restricted?
                </label>
              </div>

              <div class="inline-group" style="font-size: 0.9rem">
                <label>Shares music with a</label>
                <input type="checkbox" id="sharedMusicEmote">emote?</input>
                <input type="checkbox" id="sharedMusicLobbyMusic">lobby music?</input>
                <input type="checkbox" id="sharedMusicContrail">contrail?</input>
                <br>
                <div id="sharedMusicInputs">
                  <div class="shared-music-input-row">
                    <input type="text" class="sharedMusicInput" placeholder="e.g. Trophy Drop" hidden>
                  </div>
                </div>
                <button type="button" id="addSharedMusicBtn" class="sec-subm" style="font-size: 0.85rem; padding: 0.4rem 0.8rem; margin-top: 0.5rem; display: none;">+ Add Another</button>
              </div>

              <div class="inline-group">
                <label for="albumInput">Album Name (if applicable):</label>
                <input type="text" id="albumInput" placeholder="e.g. Album Name" style="width: 20rem;">
              </div>
            </div>

            <div class="column">
              <h4>Spotify Details</h4>
              <div class="inline-group">
                <label for="artistSpotifyLink"><b>Artist</b> Spotify Link:</label>
                <br>
                <input type="text" id="artistSpotifyLink" placeholder="https://open.spotify.com/artist/..." style="width: 30rem">
                <br>
                <small>Leave blank if multiple artists.</small>
              </div>

              <div class="inline-group">
                <label for="spotifyLink"><b>Song</b> Spotify Link:</label>
                <br>
                <input type="text" id="spotifyLink" placeholder="https://open.spotify.com/track/..." style="width: 30rem">
              </div>

              <div class="inline-group">
                <label for="spotifyTitle">Spotify Track Title:</label>
                <input type="text" id="spotifyTitle" placeholder="Track Title">
              </div>

              <div class="inline-group">
                <label for="albumSpotifyLink"><b>Album</b> Spotify Link:</label>
                <br>
                <input type="text" id="albumSpotifyLink" placeholder="https://open.spotify.com/album/..." style="width: 30rem">
              </div>
            </div>

            <div class="column">
              <h4>Other</h4>

              <div class="inline-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="collaborationCheck" checked>
                  Include Collaboration template?
                </label>
              </div>

              <div class="inline-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="displayTitle">
                  Add display title?
                </label>
              </div>
          </div>
				</section>

				<button class="sec-subm" id="generate-btn">Generate Page</button>
				<div id="status" class="status hidden"></div>
			</main>

			<aside>
				<section>
						<div class="title-box">
								<h3>Generated Page:</h3>
						</div>
						<textarea id="output" readonly placeholder="Generated MediaWiki page content will appear here..."></textarea>
						<button class="sec-subm" id="copy-btn" disabled>Copy to Clipboard</button>
						<button class="sec-subm secondary" id="clear-btn">Clear</button>
						<br>
						<button class="sec-subm" id="wiki-page-btn" disabled>Create page</button>
				</section>
			</aside>
		</div>
	</body>
</html>
